# AGO Group ビジネスプロファイリングシステム ユーザーマニュアル

## 🎯 このシステムは何をするもの？

このシステムは、会社の中で「誰が何をしているか」を自動的に分析して、わかりやすくまとめてくれるツールです。

例えば：
- 山田さんがどんな仕事をしているか
- 誰と一緒に仕事をすることが多いか
- どんな作業の流れ（ワークフロー）があるか

これらを自動的に見つけ出して、レポートを作ってくれます。

## 📋 必要なもの

1. **Python** というプログラミング言語（バージョン3.8以上）
2. **メール**や**文書**などの会社のデータ（CSVやテキストファイル）
3. このシステム（すでにインストール済み）

## 🚀 使い方（3つのステップ）

### ステップ1: データを準備する

`data/00_new/` フォルダに分析したいファイルをそのまま入れるだけ！

#### 📂 対応しているファイル形式
- **メール**: Outlook (.pst, .msg), Gmail (.mbox), 標準形式 (.eml), テキスト (.txt)
- **文書**: Word (.docx, .doc), PDF (.pdf), テキスト (.txt), マークダウン (.md), Excel (.xlsx, .xls), PowerPoint (.pptx, .ppt)
- **チャット**: LINE (.txt), Slack (.json), Teams/Zoom (.csv), メモ (.txt)

#### 🎯 使い方の例
```bash
# LINEのトーク履歴をそのまま投入
cp ~/Downloads/[LINE]営業チーム.txt data/00_new/

# メールファイルをそのまま投入
cp ~/Documents/emails_export.mbox data/00_new/

# 複数ファイルを一気に投入
cp ~/Desktop/業務ファイル/* data/00_new/
```

**💡 ヒント**: 
- データ変換は不要です
- フォルダ分けも不要です（整理したい場合はご自由に）
- 生データをそのまま `data/00_new/` に入れるだけでOK
- AIが自動的にファイルの種類と内容を理解して分析します
- 処理後は自動的に`data/01_analyzed/日付/`に移動されます

### ステップ2: 分析を実行する

ターミナルを開いて、分析レベルに応じてコマンドを選択：

#### 🟢 基本的な分析
```bash
cd /Users/ago/AG_AI
python analyze.py
```

#### 🟡 スマート分析（学習機能付き）
過去の修正を記憶して精度向上：
```bash
cd /Users/ago/AG_AI
python analyze_smart.py
```

#### 🔴 高度な分析（抽象化学習付き）
パターンを学習して似た間違いも予防：
```bash
cd /Users/ago/AG_AI
python analyze_advanced.py
```

**💡 どれを選べばいい？**
- 初めて → 基本的な分析
- 2回目以降 → スマート分析
- 最高精度 → 高度な分析

### ステップ3: 結果の確認・修正

分析結果が表示されたら、間違いがあれば対話的に修正できます：

```
=== 解析結果 ===
【識別された人物】
- 山田太郎（営業部長）← これ違う？教えてください
- 田中花子（経理）

> 山田太郎は開発部のエンジニアです
```

結果は`output/intelligent_analysis/`フォルダにJSON形式で保存されます。

## 💡 よくある質問

### Q: エラーが出たらどうすればいい？

A: 以下を確認してください：
1. ファイルが `data/00_new/` フォルダに入っているか？
2. ファイルが壊れていないか？
3. 日本語が文字化けしていないか？
4. 既に処理済みの場合は`data/01_analyzed/`を確認

### Q: 分析にどのくらい時間がかかる？

A: LLMベースの新システムでは、数秒〜数分で結果が表示されます。
データ量による変動はありますが、従来システムより大幅に高速化されています。

### Q: プライバシーは大丈夫？

A: はい、以下の機能があります：
- 個人情報のマスキング（隠す）機能
- データの暗号化
- アクセス制限

## 🧠 学習機能について

### フィードバック学習（スマート分析）
- 修正した内容を記憶
- 同じ間違いを繰り返さない
- 使えば使うほど賢くなる
- 詳細: `FEEDBACK_LEARNING_GUIDE.md`

### 抽象化学習（高度な分析）
- パターンを見つけて学習
- 似た間違いも予防
- 初めて見るケースでも警告
- 詳細: `ABSTRACT_LEARNING_GUIDE.md`

## 🛠️ 高度な使い方

### 設定ファイルを変更する

`config.yaml` ファイルで細かい設定ができます：

```yaml
# 分析の深さ（1-5、大きいほど詳しい）
analysis_depth: 3

# プライバシー設定
privacy:
  mask_emails: true  # メールアドレスを隠す
  mask_names: false  # 名前を隠す

# 出力形式
output:
  format: obsidian  # obsidian または json
```

### コマンドラインで実行する

一度に全部実行したい場合：

```bash
# 基本的な分析
venv/bin/python scripts/main.py --auto

# プライバシーモードで実行
venv/bin/python scripts/main.py --auto --privacy

# 特定の部門だけ分析
venv/bin/python scripts/main.py --auto --department "営業部"
```

### 差分更新（新しいデータだけ処理）

```bash
# 前回から変更があったファイルだけ処理
venv/bin/python scripts/main.py --incremental
```

## 📞 困ったときは

1. **エラーメッセージを確認** - 何が問題か書いてあります
2. **ログファイルを見る** - `logs/` フォルダに詳細な記録があります
3. **データを確認** - 入力ファイルの形式が正しいか確認
4. **もう一度最初から** - `output/` フォルダを削除してやり直す

## 📊 出力される情報

- **人物相関図**: 誰が誰と仕事しているか
- **業務フロー**: どんな手順で仕事が進んでいるか
- **重要な発見**: AIが見つけた興味深いパターン
- **プロジェクト概要**: 何が行われているか

結果は`output/intelligent_analysis/`フォルダにJSON形式で保存されます。

### 出力形式
結果はJSON形式で保存され、以下の情報が含まれます：
- 要約
- 識別された人物とその属性
- 検出されたワークフロー
- ビジネスインサイト
- 解析の信頼度スコア

## 🎉 まとめ

このシステムを使えば：
- 誰がどんな仕事をしているかが一目でわかる
- チームワークの改善点が見つかる
- 仕事の流れを整理できる

ぜひ活用して、より良い職場環境を作ってください！